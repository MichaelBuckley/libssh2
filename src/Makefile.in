OBJECTS = channel.o comp.o crypt.o hostkey.o kex.o mac.o misc.o packet.o publickey.o scp.o session.o sftp.o userauth.o

top_srcdir = @top_srcdir@
prefix = @prefix@
exec_prefix = @exec_prefix@
libdir = @exec_prefix@/lib
incldir = @prefix@/include

CC = @CC@
LDCC = @LDCC@
CFLAGS = -c @CFLAGS@ -Wall -I../include/ -fPIC
LDFLAGS = @LDFLAGS@
SHLIB_LDFLAGS = @SHLIB_LDFLAGS@
LIBS = @LIBS@
INSTALL = @INSTALL@

all: libssh2.@SHLIB_SUFFIX_NAME@

channel.o: channel.c
	$(CC) -o channel.o channel.c $(CFLAGS) $(LIBS)

comp.o: comp.c
	$(CC) -o comp.o comp.c $(CFLAGS) $(LIBS)

crypt.o: crypt.c
	$(CC) -o crypt.o crypt.c $(CFLAGS) $(LIBS)

hostkey.o: hostkey.c
	$(CC) -o hostkey.o hostkey.c $(CFLAGS) $(LIBS)

kex.o: kex.c
	$(CC) -o kex.o kex.c $(CFLAGS) $(LIBS)

mac.o: mac.c
	$(CC) -o mac.o mac.c $(CFLAGS) $(LIBS)

misc.o: misc.c
	$(CC) -o misc.o misc.c $(CFLAGS) $(LIBS)

packet.o: packet.c
	$(CC) -o packet.o packet.c $(CFLAGS) $(LIBS)

publickey.o: publickey.c
	$(CC) -o publickey.o publickey.c $(CFLAGS) $(LIBS)

scp.o: scp.c
	$(CC) -o scp.o scp.c $(CFLAGS) $(LIBS)

session.o: session.c
	$(CC) -o session.o session.c $(CFLAGS) $(LIBS)

sftp.o: sftp.c
	$(CC) -o sftp.o sftp.c $(CFLAGS) $(LIBS)

userauth.o: userauth.c
	$(CC) -o userauth.o userauth.c $(CFLAGS) $(LIBS)

libssh2.@SHLIB_SUFFIX_NAME@: $(OBJECTS)
	$(LDCC) -o libssh2.@SHLIB_SUFFIX_NAME@ $(SHLIB_LDFLAGS) $(OBJECTS) $(LIBS) $(LDFLAGS)
libssh2.a: $(OBJECTS)
	rm -f libssh2.a
	ar q libssh2.a $(OBJECTS)
	@RANLIB@ libssh2.a
install: all
	$(INSTALL) libssh2.@SHLIB_SUFFIX_NAME@ $(DESTDIR)$(libdir)
clean:
	rm -f *~ libssh2.a libssh2.@SHLIB_SUFFIX_NAME@ *.o

